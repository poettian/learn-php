# 版本约束

#### 名词解释

先来看关于版本的几个专有名词的解释：

**alpha版**：内部测试版。α是希腊字母的第一个，表示最早的版本，一般用户不要下载这个版本，这个版本包含很多BUG，功能也不全，主要是给开发人员和 测试人员测试和找BUG用的。

**beta版**：公开测试版。β是希腊字母的第二个，顾名思义，这个版本比alpha版发布得晚一些，主要是给“部落”用户和忠实用户测试用的，该版本任然存 在很多BUG，但是相对alpha版要稳定一些。这个阶段版本的软件还会不断增加新功能。如果你是发烧友，可以下载这个版本。

**rc版**：全写：Release Candidate（候选版本），该版本又较beta版更进一步了，该版本功能不再增加，和最终发布版功能一样。这个版本有点像最终发行版之前的一个类似 预览版，这个的发布就标明离最终发行版不远了。作为普通用户，如果你很急着用这个软件的话，也可以下载这个版本。

**stable版**：稳定版。在开源软件中，都有stable版，这个就是开源软件的最终发行版，用户可以放心大胆的用了。

#### 标签(tag)

一般而言，composer使用包仓库中的 tag 标签来匹配 composer.json 中的版本约束。

> composer 会自动去掉标签的 'v' 前缀，比如 v1.0.1 -> 1.0.1

除非指定了具体的版本，composer 会自动使用符合约束条件的最高可用版本，然后从包仓库中下载 zip 压缩包并解压到 vendor 目录下的相应位置。

#### 分支(branch)

如果想使用包仓库的某个分支而不是标签，我们需要使用 `dev-*` 前缀。composer 会**克隆**包仓库到 vendor 目录下并检出到指定分支（可以在composer install 时指定 **--prefer-source** and **--prefer-dist** 来改变该行为）。

比如：如果想使用 `my-feature` 分支，我们需要在 composer.json 中指定 require 的值为 `dev-my-feature`。

如果分支命名和标签很像，比如 v1 v2，那么需要这么指定：`v1.x-dev` ，现在使用 `-dev` 后缀而不是前缀，使用 `.x` 来指明是分支而非标签，当然也可以命名分支为 1.x。

#### 最小稳定性要求

对某个版本而言，可能存在多个不同的稳定性标签，比如：`v1.1` `v1.1-BETA` `v1.1-RC1` `v1.1-RC2`

那么当我们指定 1.1 版本时，composer 如何知道该选择哪个来下载呢？这就是最小稳定性要求。可以在根 composer.json 中指定 `minimum-stability` ，也可以在 require 的版本约束中使用 `stability flags`（下文有介绍）。具体见[Minimum Stability](https://getcomposer.org/doc/04-schema.md#minimum-stability) 。

composer 默认是 stable（级别有：`dev`, `alpha`, `beta`, `RC`, and `stable`）

#### 如何写版本约束

1. 具体版本：`1.0.2`
2. 范围版本：`空格` 或 `,` 表示逻辑与，`||` 表示逻辑或

- `>=1.0`
- `>=1.0 <2.0`
- `>=1.0 <1.1 || >=1.2`

3. 连字符范围版本：

* `1.0 - 2.0` 表示 `>=1.0.0 <2.1`

* `1.0.0 - 2.1.0` 表示 `>=1.0.0 <=2.1.0`

4. 通配符版本：`1.0.*` 表示 `>=1.0 <1.1`

5. Next Significant Release Operators(不知道怎么翻译)

**~ 字符**：

`~1.2` 表示 `>=1.2 <2.0.0` ，`~1.2.3` 表示 `>=1.2.3 <1.3.0`，`~1` 表示 `~1.0`

可以这么理解：标记所依赖的最小的次要版本；另一种看待它的方法是使用~指定一个最小版本，但允许最后一个指定的数字上升。

**^ 字符**：

`^1.2.3` 表示 `>=1.2.3 <2.0.0` ，`^0.3` 表示 `>=0.3.0 <0.4.0`，`^0.3.2` 表示 `>=0.3.2 <0.4.0`

注意和 ~ 的区别，^ 可以理解为保持功能的稳定性和向后兼容性

#### 稳定性约束(stability flags root-only)

可以使用 `@<stability>` 来指明依赖包的稳定性要求

#### 彩蛋

可以使用 [https://semver.mwl.be](https://semver.mwl.be/) 来搜索符合版本约束的包列表